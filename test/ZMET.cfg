# TDR selection procedure for Z->MuMu events
# Tested on 2007/10/04/ by J.A.

process ZmumuSelector= {

### keep the logging output to a nice level ###
      #include "FWCore/MessageLogger/data/MessageLogger.cfi"

      service = MessageLogger {
          untracked vstring destinations = { "cout" }
          untracked PSet cout = { untracked string threshold = "DEBUG" }
          #untracked vstring debugModules = { "zMuMuSelFilter", "zMuMuSelGlobalOnlyFilter", "zMuMuIsolations", "zMuMuTrackerIsolations" }
          untracked vstring debugModules = { "zMuMuSelFilter", "zMuMuSelGlobalOnlyFilter" }
      }

      service = AdaptorConfig {}

      untracked PSet maxEvents = { untracked int32 input = -1 }

      source = PoolSource {
            untracked vstring fileNames = {
                  "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0002E7A8-706F-DC11-B7C4-0016177CA778.root"
            }
            untracked uint32 debugVerbosity = 0
            untracked bool   debugFlag     = false
      }
      replace PoolSource.fileNames = {
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/00040CB2-D48A-DC11-9BBC-0019B9E48AD8.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/083F3B86-D98A-DC11-8C52-0019B9E4FD9D.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/107972E7-D18A-DC11-9906-0019B9E4F82C.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/109FC3D9-D18A-DC11-ACB0-0019B9E50108.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/1C0985D4-D18A-DC11-B674-0019B9E500D1.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/1C0C5381-D18A-DC11-AD97-0019B9E4FDCF.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/225208DB-D08A-DC11-8CA1-0019B9E490C1.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/225E1C3B-D38A-DC11-ABF6-0019B9E4FBB8.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/26A1CDF0-CF8A-DC11-B01B-0019B9E4937C.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/281A2F75-D38A-DC11-BA13-0019B9E7C86C.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/3216E67B-CE8A-DC11-942E-0019B9E4FD20.root'
      }	
      #Skim for ZToMuMu	
      #include "ElectroWeakAnalysis/ZReco/data/zToMuMu_SkimPaths.cff"
      include "ElectroWeakAnalysis/ZReco/data/zToMuMuHLTFilter.cfi"
 	
      #Muon corrections for MET	
      //include "JetMETCorrections/Type1MET/data/MetMuonCorrections.cff"		 	
      //path muonMETcorr = {MetMuonCorrections}
	
      ## Selection of ZToMuMu
      # A la TDR
      #include "ElectroWeakAnalysis/ZReco/data/ZMuMuSel_TDR_16x.cff"
      # With new/simplified isolation
      include "ElectroWeakAnalysis/ZReco/data/ZMuMuSel_NewIso_16x.cff"

      ## MET Analyzer
      module zmet = ZMETAnalyzer {
            //untracked InputTag MuonCollectionLabel = globalMuons
	    untracked InputTag ZCollectionLabel = zMuMuSelGlobalOnlyFilter	
            untracked InputTag METCollectionLabel = met

            untracked uint32 NbinsMT = 100
            untracked double MTMin = 0.
            untracked double MTMax = 200.
	    untracked uint32 NbinsMET = 100
            untracked double METMin = 0.
            untracked double METMax = 100.	
            untracked uint32 NbinsPtNu = 100
            untracked double PtNuMin = 0.
            untracked double PtNuMax = 100.

	    untracked uint32 NbinsCaloMET = 100
            untracked double CaloMETMin = 0.
            untracked double CaloMETMax = 100.
	    untracked uint32 NbinsVBPt = 100
            untracked double VBPtMin = 0.
            untracked double VBPtMax = 100.
	    untracked uint32 NbinsVBEta = 50
            untracked double VBEtaMin = 0.
            untracked double VBEtaMax = 6.

	    untracked uint32 NbinsCaloMETPhi = 50
            untracked double CaloMETPhiMin = -3.15
            untracked double CaloMETPhiMax = 3.15	
	    untracked uint32 NbinsVBPhi = 50
            untracked double VBPhiMin = -3.15
            untracked double VBPhiMax = 3.15
 
            untracked string RootFileName = "ZMET.root"
      }

      # Use Global+Global only
      #path zmumu = { zmumuselGlobalOnly, zmet }
      path zmumu = { zToMuMuHLTFilter, zmumuselGlobalOnly, zmet }	
      #path zmumu = { zToMuMuPath, zmumuselGlobalOnly, zmet }
     
      include "ElectroWeakAnalysis/ZReco/data/zToMuMu_EventContent.cff"
      include "Configuration/EventContent/data/EventContent.cff"

      block AODSIMZToMuMuEventContent = {
  	untracked vstring outputCommands = { 
  	}
      }

      replace AODSIMZToMuMuEventContent.outputCommands += AODSIMEventContent.outputCommands
      replace AODSIMZToMuMuEventContent.outputCommands += zToMuMuEventContent.outputCommands 	 

      block TestEventContent = {
	untracked vstring outputCommands = {
		'drop *',
		'keep *_*_*_ZmumuSelector' 
	}
      }		
      module zToMuMuOutput = PoolOutputModule {
        untracked string fileName = "/scratch/pereira/zToMuMu.root"
        #using AODSIMEventContent
	#using AODSIMZToMuMuEventContent
	using TestEventContent
        untracked PSet SelectEvents = {
                //vstring SelectEvents = {"zmumu"}
		vstring SelectEvents = {"zToMuMuPath"}
        }
        untracked PSet dataset ={
                untracked string dataTier = "USER"
                untracked string filterName = "zToMuMu_Selector"
        }
      }
      //endpath end = { zToMuMuOutput }
      

}
                                                                                                          

