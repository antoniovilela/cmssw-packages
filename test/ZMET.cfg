# TDR selection procedure for Z->MuMu events
# Tested on 2007/10/04/ by J.A.

process ZmumuSelector= {

### keep the logging output to a nice level ###
      #include "FWCore/MessageLogger/data/MessageLogger.cfi"

      service = MessageLogger {
          untracked vstring destinations = { "cout" }
          untracked PSet cout = { untracked string threshold = "DEBUG" }
          #untracked vstring debugModules = { "zMuMuSelFilter", "zMuMuSelGlobalOnlyFilter", "zMuMuIsolations", "zMuMuTrackerIsolations" }
          #untracked vstring debugModules = { "zMuMuSelFilter", "zMuMuSelGlobalOnlyFilter" }
      }

      service = AdaptorConfig {}

      untracked PSet maxEvents = { untracked int32 input = 10000 }

      source = PoolSource {
            untracked vstring fileNames = {
                  //13x
                  //"/store/mc/2007/5/9/Spring07-ZToMuMu-1532/0001/000AB61E-B2FF-DB11-8E42-00304885AA6A.root"
                  //16x
                  //"/store/RelVal/2007/9/3/RelVal-RelValZMM-1188837971/0002/447E5AA1-635A-DC11-B2A3-000423D94AA8.root"
                  //"rfio:/castor/cern.ch/user/j/jalcaraz/crab/RelVal160pre14Z-MM_Raw.root"
                  "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0002E7A8-706F-DC11-B7C4-0016177CA778.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/000CE19E-716F-DC11-87C8-0030485628B4.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/00319141-726F-DC11-8309-000423D9989E.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0035C57D-716F-DC11-94AE-001617DBD5B2.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0048E2B8-6F6F-DC11-8893-001617C3B712.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0073AD99-706F-DC11-929D-000423D94534.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/007809D3-4E6F-DC11-9478-000423D99B46.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/008D76E9-6F6F-DC11-A485-000423D98A44.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/00A66685-706F-DC11-A3E7-001617C3B64C.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/00BEBB09-706F-DC11-AAB9-001617C3B78C.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/00DEA3EE-6E6F-DC11-87D9-001617DBCF70.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/00FC747A-716F-DC11-8664-000423D98844.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0217DEDA-716F-DC11-B43B-000423D99660.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0232DDC3-6E6F-DC11-A2FE-00304885AA9C.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0238D171-716F-DC11-A61A-0030485628A0.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/023D4A0D-716F-DC11-8F37-003048560F10.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/0260B386-706F-DC11-B8BB-000423D952C0.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/02D171A5-4F6F-DC11-BFCB-00304885AA54.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/02E95613-716F-DC11-A381-0030485628D4.root"
                  , "/store/mc/2007/9/30/CSA07-DrellYan_mumu_40-A2/0000/02EDFFD3-716F-DC11-8405-003048562976.root"
            }
            untracked uint32 debugVerbosity = 0
            untracked bool   debugFlag     = false
      }
      replace PoolSource.fileNames = {
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/00040CB2-D48A-DC11-9BBC-0019B9E48AD8.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/083F3B86-D98A-DC11-8C52-0019B9E4FD9D.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/107972E7-D18A-DC11-9906-0019B9E4F82C.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/109FC3D9-D18A-DC11-ACB0-0019B9E50108.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/1C0985D4-D18A-DC11-B674-0019B9E500D1.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/1C0C5381-D18A-DC11-AD97-0019B9E4FDCF.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/225208DB-D08A-DC11-8CA1-0019B9E490C1.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/225E1C3B-D38A-DC11-ABF6-0019B9E4FBB8.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/26A1CDF0-CF8A-DC11-B01B-0019B9E4937C.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/281A2F75-D38A-DC11-BA13-0019B9E7C86C.root',
		'/store/mc/2007/10/19/CSA07-Zmumu-1192835913/0000/3216E67B-CE8A-DC11-942E-0019B9E4FD20.root'
      }	
      #Skim new collections for ZToMuMu	
      #include "ElectroWeakAnalysis/ZReco/data/zToMuMuSequences.cff"	
      #include "ElectroWeakAnalysis/ZReco/data/zToMuMuFilter.cfi"
      #path zToMuMuPath = { zToMuMuHLTFilter & muonRecoForZToMuMu & zToMuMu & zToMuMuFilter & muonMCTruthForZToMuMu }
      #sequence zToMuMuPath = { muonRecoForZToMuMu & zToMuMu & zToMuMuFilter & muonMCTruthForZToMuMu }
      include "ElectroWeakAnalysis/ZReco/data/zToMuMu_SkimPaths.cff"
	
      #Muon corrections for MET	
      include "JetMETCorrections/Type1MET/data/MetMuonCorrections.cff"		 	
      path muonMETcorr = {MetMuonCorrections}
	
      ## Selection of ZToMuMu
      # A la TDR
      #include "ElectroWeakAnalysis/ZReco/data/ZMuMuSel_TDR_13x.cff"
      #include "ElectroWeakAnalysis/ZReco/data/ZMuMuSel_TDR_16x.cff"
      # With new/simplified isolation
      #include "ElectroWeakAnalysis/ZReco/data/ZMuMuSel_NewIso_13x.cff"
      include "ElectroWeakAnalysis/ZReco/data/ZMuMuSel_NewIso_16x.cff"

      ## MET Analyzer
      module zmet = ZMETAnalyzer {
            //untracked InputTag MuonCollectionLabel = globalMuons
	    untracked InputTag ZCollectionLabel = zMuMuSelGlobalOnlyFilter	
            untracked InputTag METCollectionLabel = met

            untracked uint32 NbinsMT = 100
            untracked double MTMin = 0.
            untracked double MTMax = 200.
	    untracked uint32 NbinsMET = 100
            untracked double METMin = 0.
            untracked double METMax = 100.	
            untracked uint32 NbinsPtNu = 50
            untracked double PtNuMin = 0.
            untracked double PtNuMax = 100.

	    untracked uint32 NbinsCaloMET = 100
            untracked double CaloMETMin = 0.
            untracked double CaloMETMax = 100.
	    untracked uint32 NbinsVBPt = 50
            untracked double VBPtMin = 0.
            untracked double VBPtMax = 100.
	    untracked uint32 NbinsVBEta = 50
            untracked double VBEtaMin = 0.
            untracked double VBEtaMax = 6.
	 
            untracked string RootFileName = "ZMET.root"
      }

      # Use Global+Global only
      path zmumu = { zmumuselGlobalOnly, zmet }
      #path zmumu = { zToMuMuPath, zmumuselGlobalOnly, zmet }
     
      include "ElectroWeakAnalysis/ZReco/data/zToMuMu_EventContent.cff"
      include "Configuration/EventContent/data/EventContent.cff"

      block AODSIMZToMuMuEventContent = {
  	untracked vstring outputCommands = { 
  	}
      }

      replace AODSIMZToMuMuEventContent.outputCommands += AODSIMEventContent.outputCommands
      replace AODSIMZToMuMuEventContent.outputCommands += zToMuMuEventContent.outputCommands 	 

      block TestEventContent = {
	untracked vstring outputCommands = {
		'drop *',
		'keep *_*_*_ZmumuSelector' 
	}
      }		
      module zToMuMuOutput = PoolOutputModule {
        untracked string fileName = "/tmp/antoniov/zToMuMu.root"
        #using AODSIMEventContent
	#using AODSIMZToMuMuEventContent
	using TestEventContent
        untracked PSet SelectEvents = {
                //vstring SelectEvents = {"zmumu"}
		vstring SelectEvents = {"zToMuMuPath"}
        }
        untracked PSet dataset ={
                untracked string dataTier = "USER"
                untracked string filterName = "zToMuMu_Selector"
        }
      }
      endpath end = { zToMuMuOutput }
      

}
                                                                                                          

